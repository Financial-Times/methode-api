server:
  applicationConnectors:
    - type: http
      port: 8080

  adminConnectors:
      - type: http
        port: 8081

  requestLog:
    appenders:

      - type: file

        # The file to which current statements will be logged.
        currentLogFilename: /var/log/apps/methode-api-dw-access.log

        # When the log file rotates, the archived log will be renamed to this and gzipped. The
        # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
        # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
        archivedLogFilenamePattern: /var/log/apps/methode-api-dw-access-%d.log.gz

        # The number of archived files to keep.
        archivedFileCount: 5

        # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
        timeZone: UTC

logging:
  level: INFO

  loggers:
    io.dropwizard: DEBUG
    "com.sun.jersey.spi.container.ContainerResponse": OFF
    "com.ft.methodeapi.service.methode.connection.MethodeConnectionAllocator" : DEBUG
    "com.ft.methodeapi.service.methode.connection.PoolingMethodeObjectFactory" : DEBUG
    "com.ft.methodeapi.service.methode.connection.SelfCleaningPool" : DEBUG

  appenders:
    - type: file
      logFormat: "%-5p [%d{ISO8601, GMT}] %c: %X{transaction_id} %m [%thread]%n%xEx"
      # Do not write log statements below this threshold to the file.
      threshold: ALL

      # The file to which current statements will be logged.
      currentLogFilename: /var/log/apps/methode-api-dw-app.log

      # When the log file rotates, the archived log will be renamed to this and gzipped. The
      # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
      # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
      archivedLogFilenamePattern: /var/log/apps/methode-api-dw-app-%d.log.gz

      # The number of archived files to keep.
      archivedFileCount: 5

      # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
      timeZone: UTC

credentialsPath: /etc/methode-api-credentials.properties
testCredentialsPath: /etc/methode-api-test-credentials.properties

methodeConnection:
  hostName: <%=scope.function_hiera(['methodeHostName'])%>
  nsPort: <%=scope.function_hiera(['methodeNameServicePort'])%>
  connectTimeout: 2000
  maxPingMillis: 2000
  pool:
    size: 10
    timeout: 1900ms
methodeTestConnection:
  hostName: <%=scope.function_hiera(['methodeHostName'])%>
  nsPort: <%=scope.function_hiera(['methodeNameServicePort'])%>
  connectTimeout: 2000
  maxPingMillis: 2000
  pool:
    size: 2
    timeout: 4000ms

